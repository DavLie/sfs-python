"""Compute the sound field generated by a sound source.

The Green's function describes the spatial sound propagation over time.

"""

import numpy as np
from .. import util
from .. import defs


def greens_function_ps(xs, grid, t, fs=None, c=None):
    """Source model for a point source: 3D Green's function.

    ::

                         1
         g(x-xs,t) = ---------- delta(t - |x-xs|/c)
                     4pi |x-xs|

    """
    xs = util.asarray_1d(xs)
    grid = util.as_xyz_components(grid)
    if c is None:
        c = defs.c
    if fs is None:
        fs = defs.fs
    r = np.linalg.norm(grid - xs)
    g = 1 / (4*np.pi*r)
    t = (r/c)*fs-t
    return g, t
